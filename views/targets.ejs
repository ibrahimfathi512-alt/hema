<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <style>
        body { background: #f8fafb; font-family: 'Segoe UI', sans-serif; padding: 25px; }
        .nav { background: white; padding: 15px; border-radius: 15px; display: flex; justify-content: space-between; margin-bottom: 25px; box-shadow: 0 2px 10px rgba(0,0,0,0.05); }
        .stats-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px; margin-bottom: 30px; }
        .card { background: white; padding: 20px; border-radius: 15px; text-align: center; border-bottom: 5px solid #ff5e00; }
        .card h4 { margin: 0; color: #636e72; }
        .card h2 { margin: 10px 0 0 0; font-size: 2.2em; color: #2d3436; }
        
        table { width: 100%; border-collapse: collapse; background: white; border-radius: 15px; overflow: hidden; box-shadow: 0 4px 10px rgba(0,0,0,0.05); }
        th { background: #636e72; color: white; padding: 15px; }
        td { padding: 12px; border-bottom: 1px solid #eee; text-align: center; font-weight: bold; }

        /* Ù†Ø¸Ø§Ù… ØªÙ„ÙˆÙŠÙ† Ø§Ù„Ø£Ø¯Ø§Ø¡ */
        .perf-excellent { background-color: #28a745 !important; color: white; } /* Ø£Ø®Ø¶Ø± - Ø¹Ø§Ø´ ÙŠØ§ Ø¨Ø·Ù„ */
        .perf-good { background-color: #ffc107 !important; color: #333; }      /* Ø£ØµÙØ± - Ù…ØªÙˆØ³Ø· */
        .perf-poor { background-color: #dc3545 !important; color: white; }    /* Ø£Ø­Ù…Ø± - ØªØ­Øª 80 */
        .badge { padding: 5px 12px; border-radius: 20px; font-size: 0.85em; display: inline-block; }
    </style>
</head>
<body>
    <div class="nav">
        <h2>ØªØ­Ù„ÙŠÙ„ ØªØ§Ø±Ø¬Øª: <%= zone %></h2>
        <a href="/dashboard" style="text-decoration:none; color:#ff5e00; font-weight:bold;">Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„Ø±Ø¦ÙŠØ³ÙŠØ© ğŸ </a>
    </div>

    <div class="stats-grid">
        <div class="card">
            <h4>Ø§Ù„ØªØ§Ø±Ø¬Øª Ø§Ù„Ù…Ø·Ù„ÙˆØ¨ (Target)</h4>
            <h2><%= cleanData(zoneData.get('normal Target')) %></h2>
        </div>
        <div class="card">
            <h4>Ø§Ù„Ù…ØªÙˆØ³Ø· Ø§Ù„Ø­Ø§Ù„ÙŠ (Average)</h4>
            <h2><%= cleanData(zoneData.get('Average')) %></h2>
        </div>
        <div class="card">
            <h4>Ù†Ø³Ø¨Ø© Ø§Ù„ØªØ­Ù‚ÙŠÙ‚ Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠØ©</h4>
            <h2 style="color: #28a745;"><%= zoneData.get('Average %') %></h2>
        </div>
    </div>

    <table>
        <thead>
            <tr>
                <th>Ø§Ù„ØªØ§Ø±ÙŠØ®</th>
                <th>Ø§Ù„Ø³Ø§Ø¹Ø§Øª Ø§Ù„Ù…Ø­Ù‚Ù‚Ø©</th>
                <th>Ù†Ø³Ø¨Ø© ØªØ­Ù‚ÙŠÙ‚ Ø§Ù„ÙŠÙˆÙ…</th>
                <th>Ø§Ù„ØªÙ‚ÙŠÙŠÙ…</th>
            </tr>
        </thead>
        <tbody>
            <% headers.forEach(h => { 
                if(h.includes('/')) { 
                    let val = cleanData(zoneData.get(h)); // Ù‚Ø±Ø§Ø¡Ø© 90.9 ØµØ­ÙŠØ­Ø©
                    let target = cleanData(zoneData.get('normal Target'));
                    let pct = (target > 0) ? (val / target * 100) : 0;
                    
                    let rowClass = '';
                    let statusText = '';
                    if (pct >= 90) { rowClass = 'perf-excellent'; statusText = 'Ø¹Ø§Ø´ ÙŠØ§ Ø¨Ø·Ù„ Ø§Ø³ØªÙ…Ø± ğŸ†'; }
                    else if (pct >= 85) { rowClass = 'perf-excellent'; statusText = 'Ø£Ø¯Ø§Ø¡ Ù…Ù…ØªØ§Ø² â­'; }
                    else if (pct >= 80) { rowClass = 'perf-good'; statusText = 'Ù…ØªÙˆØ³Ø· âš ï¸'; }
                    else { rowClass = 'perf-poor'; statusText = 'Ø£Ø¯Ø§Ø¡ Ø¶Ø¹ÙŠÙ âŒ'; }
            %>
            <tr>
                <td><%= h %></td>
                <td><%= val %> Ø³Ø§Ø¹Ø©</td>
                <td><%= pct.toFixed(1) %>%</td>
                <td class="<%= rowClass %>"><%= statusText %></td>
            </tr>
            <% } }); %>
        </tbody>
    </table>
</body>
</html>